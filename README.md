# tkExporter For Blender

### 概要
tkEngine用のファイルフォーマットtks,tka,tklを出力するBlenderのアドオンです。

### インストール方法
「Blender アドオン インストール」でggr

### 使い方

###### 共通
- プロパティ(デフォルトでは右下にあるいろんな設定ができる画面)
- ↓
- オブジェクト(その左端にあるオレンジ色の四角のアイコンのタブ)
- ↓
- TkExporter
- ↓
- createSkeleton, createAnimation, createLevel の3つのボタンがある。

###### スケルトン出力(.tks)
- Armatureオブジェクトを選択。(オブジェクトモードに変更しないと選択できない場合があります。既に他のオブジェクトの編集モードに入ってる場合とか。)  
- ↓  
- createSkeletonのボタンを押す 
- ↓  
- フォルダとファイル名を指定して、キャンセルボタンの上のcreateSkeletonを押す。

###### アニメーション出力(.tka)
- 任意：アニメーションを作る際に、ポーズマーカーを設定しておくと、アニメーションイベントとして出力します。
- ↓
- Armatureオブジェクトを選択。(Armatureオブジェクトにはアクションがセットされている必要があります。)  
- ↓  
- createAnimationのボタンを押す 
- ↓  
- フォルダとファイル名を指定して、キャンセルボタンの上のcreateAnimationを押す。

###### レベル出力(.tkl)
- コレクションを選択。(コレクションを選択しない場合は、シーンコレクションを選択した扱いになって、すべてのオブジェクトが対象になります。) 
- ↓  
- createLevelのボタンを押す 
- ↓
- 名前のドット以下削除オプションを使いたい場合はDelete name after the dotにチェックを入れる。
  - 名前のドット以下削除オプションはオブジェクトの名前のドット(.)とその後ろを削除します。「Box.001」が「Box」になります。
    Blenderはオブジェクトの名前を重複させられないので、この機能が導入されました。
- ↓  
- フォルダとファイル名を指定して、キャンセルボタンの上のcreateLevelを押す。

### モデル作成時に気を付けること
  
fbx書き出し時は、"スケールを適用"を「すべてFBX」に、「-Zが前方」、「yが上」にして、「アーマチュア」「メッシュ」を選択して書き出してください。拡大縮小はなぜかいじってもモデルの大きさが変わらない・・・なぜなのかしらん。
  
頂点ウェイトを編集した後などは3Dビューポート→メッシュ→ウェイト→すべてを正規化、を行わないと、Blenderでは大丈夫でもゲーム内ではおかしなアニメーションになることがあります。